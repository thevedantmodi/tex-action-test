on: [push]
permissions:
  contents: write
jobs:
  build-and-deploy:
    concurrency: ci-${{ github.ref }} # Recommended if you intend to make multiple deployments in quick succession.
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 🛎️
        uses: actions/checkout@v4
      - name: Compile TeX -> PDF
        uses: xu-cheng/latex-action@v2
        with:
            root_file: source.tex
      - name: Place output
        run: mkdir build && mv source.pdf build/ && mv index.html build/
      - name: Deploy 🚀
        uses: JamesIves/github-pages-deploy-action@v4
        with:
          folder: build # The folder the action should deploy.
# jobs:
#   build-tex:
#     runs-on: ubuntu-latest
#     name: Build all tex files to PDF
#     steps:
#       - name: Checkout code
#         uses: actions/checkout@v4
#       - name: Compile TeX -> PDF
#         uses: xu-cheng/latex-action@v2
#         with:
#             root_file: source.tex
#       - name: Upload the build product
#         uses: actions/upload-artifact@v4
#         with:
#             name: PDF Release
#             path: ./source.pdf
#   push-pdf:
#       runs-on: ubuntu-latest
#       name: Download PDF from jobs archive
#       needs: build-tex
#       steps:
#         - name: Download PDF
#           uses: actions/download-artifact@v4
#           with:
#             name: PDF Release
#         - name: Create git repository
#           run: git init
#         - name: Deploy to pages
#           uses: JamesIves/github-pages-deploy-action@v4
#           with: 
#             folder: .
#             branch: gh-pages

        # - name: Push to GitHub
        #   run: |
        #     git init
        #     git config --global user.name "github-actions[bot]"
        #     git config --global user.email "41898282+github-actions[bot]@users.noreply.github.com"
        #     # git remote add origin git@github.com:.git
        #     git remote set-url origin "https://$MY_NAME:${{ secrets.MY_PASSWORD }}@github.com/${{github.repository}}.git"
        #     git status
        #     git add source.pdf
        #     git status
        #     git checkout -B build
        #     git commit -m "[bot] Add built PDF"
        #     git push --set-upstream origin build
        #     echo "pushed to github repo"
        #   env:
        #     GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
            
  # create-release:
  #   runs-on: ubuntu-latest
  #   name: Create PDF release

      # 

